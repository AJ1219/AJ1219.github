<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>AJAX | Abel-Johnson's BLOG</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/blog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">AJAX</h1><a id="logo" href="/blog/.">Abel-Johnson's BLOG</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> 首页</i></a><a href="/blog/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/blog/about/"><i class="fa fa-user"> 关于</i></a><a href="/blog/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">AJAX</h1><div class="post-meta">2017-01-06</div><div class="post-content"><h2><span id="作用-从服务端获取数据"><strong><em>作用: 从服务端获取数据</em></strong></span></h2><ol>
<li>浏览网页流程  (打开页面.请求服务端内容)<br>客户端(client)向服务器(server)请求数据<br>服务器返回数据给客户端</li>
<li>协议:<ul>
<li>file:// (本地协议, 访问本地的数据)</li>
<li>https:// (超文本传输协议,访问到服务器的数据)</li>
</ul>
</li>
<li>域名:<br> baidu.com</li>
<li>如果想让别人访问自己的页面,就要把自己的资源上传到别人可以访问到的服务器上</li>
<li>wamp(win平台服务器集成软件)</li>
<li>域名最终会解析成ip,如www.baidu.com会被解析成ip: 192.202.x.x,所以直接在地址栏输入ip也可以访问</li>
<li>自带计算机域名是localhost,ip为127.0.0.1</li>
<li><p>jQuery里的格式:</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">	url: <span class="string">'xxx.php'</span>,</span><br><span class="line">	data: &#123;</span><br><span class="line">		key1: value1,</span><br><span class="line">		key2: value2,</span><br><span class="line">		....			</span><br><span class="line">	&#125;</span><br><span class="line">	success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">		data = <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">		...(渲染语句)</span><br><span class="line">	&#125;,</span><br><span class="line">	error: <span class="function"><span class="keyword">function</span>(<span class="params">data,a</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(data)----data是一个ajax对象,其中有属性status(表征获取成功与否的http状态码,如<span class="number">404</span>)和描述statusText	</span><br><span class="line">		<span class="built_in">console</span>.log(a)---(如果是error就说明出错了)	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>一些状态码:</p>
<ul>
<li>200请求成功</li>
<li>304成功,(特殊的,走的缓存)</li>
</ul>
</li>
</ol>
<blockquote>
<p><strong>关于apache配置:</strong></p>
<ol>
<li>有冲突,改端口</li>
<li>把有个地方的配置改成all</li>
<li>关于修改根目录,详见同级文件夹里的apache说明txt文件</li>
</ol>
</blockquote>
<hr>
<h2><span id="ajaxasynchronous-javascript-and-xml工作原理">AJAX(Asynchronous Javascript And Xml)工作原理</span></h2><p>校验注册信息,如用户名 时,先用正则表达式判断语法,然后发给后台,校验是否已存在</p>
<p><form action="xx(提交地址).xx" method="(提交方法)get/post"><br>两种方法中只有<strong>get</strong>方式才会把所填的信息<strong>显示在地址栏</strong>上,post不会显示在地址栏</form></p>
<p>search/hash<br>search是?开头的键值对: ?key=value &amp; key=value</p>
<p>ajax对象: XMLHttpRequest构造函数xhr</p>
<hr>
<h4><span id="get和post区别"><em>get和post</em>区别:</span></h4><p>一个是通过地址栏url传递数据<br>另一个是通过把数据用send方法传给后台,数据不会暴露在地址栏</p>
<hr>
<p>原生方法:</p>
<ol>
<li><p>构造对象<br>var xhr = new XMLHttpRequest;</p>
</li>
<li><p>链接地址,准备数据<br>xhr.open(‘Get’,’<a href="http://xxx.php?user=" target="_blank" rel="noopener">http://xxx.php?user=</a>‘ +username,false)<br> xhr.open(‘Post’,’<a href="http://xxx.php?user=" target="_blank" rel="noopener">http://xxx.php?user=</a>‘ ,true)<br> <em>上边第三个参数是是否异步,false是同步,true是异步</em></p>
</li>
<li><p>服务器响应请求,所有请求响应完毕后会触发一个事件  (该事件要提前绑定好,有可能响应速度很快)</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">//校验完成(无论成功还是失败)后返回的数据(如'用户名已经存在'):</span></span><br><span class="line">	<span class="keyword">var</span> data = xhr.responseText;</span><br><span class="line">	<span class="comment">//然后使用该属性,显示在页面中就好,就做到了局部刷新</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取到状态码,</span></span><br><span class="line">	xhr.status</span><br><span class="line">	<span class="comment">//....此时,校验已完成....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>发送给服务器<br><strong>GET方法下</strong>:<br><code>xhr.send()</code><br><strong>POST方法下</strong>:<br>post可以提交多种格式的数据,设置一个请求头,告诉后端发送的是什么样的格式的数据   </p>
<pre><code>`xhr.setRequestHeader(&quot;Content-Type&quot;,&apos;application/x-www-form-urlencoded&apos;) `  
</code></pre><p>最后,<br><code>xhr.send(&quot;user=&quot; + this.value)</code></p>
</li>
</ol>
<hr>
<h4><span id="流程如下">流程如下</span></h4><p>每个流程对应一个<strong>编号</strong>,一个属性的值(xhr.readyState)</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:left">步骤</th>
<th style="text-align:center">编号(xhr.readyState)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">构造对象</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">链接地址,准备数据</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">发送给服务器</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">服务器响应,返回数据</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:left">全部响应完毕,触发onload事件</td>
<td style="text-align:center">4</td>
</tr>
</tbody>
</table>
<hr>
<blockquote>
<p><strong>异步&amp;同步</strong><br>js代码是<em>自上而下</em>执行的(也即默认同步执行)<br>异步就是说前面代码很耗时时,下面代码不会等到上面代码执行完后就先执行<br>同步就是严格自上而下执行</p>
</blockquote>
<h4><span id="自己封装的ajax函数仿jquery中的ajax">自己封装的ajax函数(仿jquery中的<code>$.ajax()</code>)</span></h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cn"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jq3.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"userName"</span> <span class="attr">type</span>=<span class="string">""</span> <span class="attr">name</span>=<span class="string">"user"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"tip"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>手机号码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"tellNumber"</span> <span class="attr">type</span>=<span class="string">""</span> <span class="attr">name</span>=<span class="string">"user"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"tip1"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"提交"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jq3.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">			/*</span></span><br><span class="line"><span class="undefined">				封装的是get请求和post请求这两种情况</span></span><br><span class="line"><span class="undefined">				</span></span><br><span class="line"><span class="undefined">				不一样的：</span></span><br><span class="line"><span class="undefined">					请求方式不一样 传参  默认 get</span></span><br><span class="line"><span class="undefined">					请求地址不一样 传参  *</span></span><br><span class="line"><span class="javascript">					可设置同步异步  传参  默认 <span class="literal">true</span></span></span><br><span class="line"><span class="javascript">					请求的数据      传参  默认为<span class="string">""</span></span></span><br><span class="line"><span class="undefined">					成功的回调函数  传参  </span></span><br><span class="line"><span class="undefined">						执行成功回调函数的时候得到后端传过来的数据</span></span><br><span class="line"><span class="undefined">					失败的回调函数  传参  </span></span><br><span class="line"><span class="undefined">						状态码</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">			*/</span></span><br><span class="line"><span class="javascript">			<span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">options</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">var</span> defaults = &#123;</span></span><br><span class="line"><span class="javascript">					url:<span class="string">""</span>,        <span class="comment">//请求地址</span></span></span><br><span class="line"><span class="javascript">					method:<span class="string">"get"</span>,  <span class="comment">//请求方式</span></span></span><br><span class="line"><span class="javascript">					data:<span class="string">''</span>,       <span class="comment">//请求的数据</span></span></span><br><span class="line"><span class="javascript">					isAsyn:<span class="literal">true</span>,   <span class="comment">//是否为异步</span></span></span><br><span class="line"><span class="javascript">					success:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;, <span class="comment">//成功执行的回掉函数</span></span></span><br><span class="line"><span class="javascript">					error:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;    <span class="comment">//失败执行的回掉函数</span></span></span><br><span class="line"><span class="undefined">				&#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">				$.extend(defaults,options);</span></span><br><span class="line"><span class="javascript">				<span class="comment">//如果地址没有填写，抛出错误</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>( defaults.url.trim() === <span class="string">""</span> )&#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"请求地址不能为空"</span>);</span></span><br><span class="line"><span class="undefined">				&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">				<span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>( defaults.method === <span class="string">"get"</span> )&#123;</span></span><br><span class="line"><span class="javascript">					defaults.url += <span class="string">"?"</span>+defaults.data;</span></span><br><span class="line"><span class="undefined">				&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">				xhr.open(defaults.method,defaults.url,defaults.isAsyn);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">				xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">if</span>( xhr.status === <span class="number">200</span> )&#123;  <span class="comment">//成功</span></span></span><br><span class="line"><span class="undefined">						defaults.success(xhr.responseText)</span></span><br><span class="line"><span class="javascript">					&#125; <span class="keyword">else</span> &#123; <span class="comment">//失败</span></span></span><br><span class="line"><span class="undefined">						defaults.error(xhr.status,xhr.statusText);</span></span><br><span class="line"><span class="undefined">					&#125;</span></span><br><span class="line"><span class="undefined">				&#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>( defaults.method === <span class="string">"get"</span> )&#123;</span></span><br><span class="line"><span class="undefined">					xhr.send();</span></span><br><span class="line"><span class="javascript">				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(defaults.method === <span class="string">"post"</span>)&#123;</span></span><br><span class="line"><span class="javascript">					xhr.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">'application/x-www-form-urlencoded'</span>);</span></span><br><span class="line"><span class="undefined">					xhr.send(defaults.data);</span></span><br><span class="line"><span class="undefined">				&#125;</span></span><br><span class="line"><span class="undefined">			&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">			userName.onblur = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="undefined">				ajax(&#123;</span></span><br><span class="line"><span class="javascript">					url:<span class="string">'http://localhost/2017-01-10/php/post.php'</span>,</span></span><br><span class="line"><span class="javascript">					data:<span class="string">"user="</span>+<span class="keyword">this</span>.value,</span></span><br><span class="line"><span class="javascript">					method:<span class="string">"post"</span>,</span></span><br><span class="line"><span class="javascript">					success:<span class="function"><span class="keyword">function</span> (<span class="params">data</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">						<span class="built_in">console</span>.log( data );</span></span><br><span class="line"><span class="undefined">					&#125;</span></span><br><span class="line"><span class="undefined">				&#125;);	</span></span><br><span class="line"><span class="undefined">			&#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">			tellNumber.onblur = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="undefined">				ajax(&#123;</span></span><br><span class="line"><span class="javascript">					url:<span class="string">"http://localhost/2017-01-10/php/get.php"</span>,</span></span><br><span class="line"><span class="javascript">					data:<span class="string">"user="</span>+<span class="keyword">this</span>.value,</span></span><br><span class="line"><span class="undefined">					success(data)&#123;</span></span><br><span class="line"><span class="javascript">						<span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="undefined">					&#125;</span></span><br><span class="line"><span class="undefined">				&#125;);		</span></span><br><span class="line"><span class="undefined">			&#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">		</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p>#兼容性<br>get方法:IE下,中文要手动进行url编码,ie才会识别<br>post方法: 由于设置了请求头,就不需要url编码了</p>
<blockquote>
<p> url编码<br>encodeURI(“哈”)—–编码<br>decodeURI(“%E5%F2%DD”)—–解码</p>
</blockquote>
<p>#上传&amp;&amp;下载</p>
<p>下载会调用第三方下载工具,就不说了<br>主要讲<strong>上传</strong></p>
<p><strong>上传本地文件(用input:files标签)</strong>  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"(后端约定好的)"</span> <span class="attr">id</span>=<span class="string">"fileInput"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"上传"</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">	<span class="comment">//要用post方法  </span></span></span><br><span class="line"><span class="javascript">	btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest;</span></span><br><span class="line"><span class="javascript">		xhr.open(<span class="string">"post"</span>, url, <span class="literal">true</span>);</span></span><br><span class="line"><span class="javascript">		<span class="comment">//不能用value,value只会拿到该文件的本地路径,要用files,对应的是一个数组</span></span></span><br><span class="line"><span class="javascript">		<span class="built_in">console</span>.log(fileInput.files[<span class="number">0</span>]);</span></span><br><span class="line"><span class="javascript">		<span class="comment">//用files拿到要上传的文件以后,要把它转换成二进制文件↘</span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> fd = <span class="keyword">new</span> FormData();</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="javascript">		<span class="comment">//append()是fd对象的方法,第一个参数是key值(前后端约定好的) </span></span></span><br><span class="line"><span class="javascript">		fd.append(<span class="string">"files"</span>, fileInput.files[<span class="number">0</span>]);</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="undefined">		</span></span><br><span class="line"><span class="javascript">		<span class="comment">//就不用这么写了---xhr.send("file="+fileInput.files[0]);</span></span></span><br><span class="line"><span class="undefined">	&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h1><span id="跨域">跨域</span></h1><ol>
<li><p>同源策略(域名,协议,端口()http:80;https:443;ftp:21 22 23相同)<br> 百度只能获取到自己的数据,但不能访问到taobao的数据</p>
<blockquote>
<pre><code>www.baidu.com 主域名(一级域名)  
news.baidu.com 二级域名  
123.ss.baidu.com 三级域名
</code></pre></blockquote>
<p> 当浏览器的百度tab页执行一个脚本的时候会检查这个脚本是属于哪个页面的，<br>即检查是否同源，只有和百度同源的脚本才会被执行</p>
</li>
<li><p>电脑上每个软件都有一个端口</p>
</li>
</ol>
<h1><span id="跨域方式">跨域方式:</span></h1><ol>
<li>Ajax方法<ol>
<li>后端加一个请求头部,允许指定ip或者*(任何ip)访问数据</li>
<li>请求本地服务器的后台程序,在这个后台程序里请求别的服务器的后台数据(后台之间请求数据不存在跨域问题)</li>
<li><del>flash方法</del></li>
</ol>
</li>
<li><p>jsonp(json+padding用json格式来填充数据)方式<br> 后端设置jsonp的请求格式 ,只能用get方式<br> <code>&lt;img src可以用base64(是一串字符串,图片的一种格式)来写,浏览器不关心里边数据是什么样子,他关心数据能否转成一张图片&gt;</code>,<code>&lt;script&gt;</code>,<code>&lt;link&gt;</code>三类标签是可以跨域的<br> jsonp是用script标签来跨域的,举例:</p>
<ol>
<li><p>(动态引入js)点击document生成一个script标签,这个标签的src属性是外部的php,js之类的文件的地址,这个时候在他们的文件内部要有一个函数调用,如fn();与此同时在函数外部,要定义这个函数,以便执行刚才的调用</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">abc</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">"script"</span>);</span><br><span class="line">	script.src = <span class="string">"http://192.168.2.138/2017-11-12/kuayu/jsonp.php?cb=abc"</span></span><br><span class="line">	<span class="built_in">document</span>.body.appendChild(script);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>cb =&gt; callback</code></p>
</li>
</ol>
</li>
</ol>
</div><div class="tags"><a href="/blog/tags/DOM/"><i class="fa fa-tag"></i>DOM</a><a href="/blog/tags/HTML/"><i class="fa fa-tag"></i>HTML</a><a href="/blog/tags/JavaScript/"><i class="fa fa-tag"></i>JavaScript</a><a href="/blog/tags/前端/"><i class="fa fa-tag"></i>前端</a></div><div class="post-nav"><a class="pre" href="/blog/2017/01/06/闭包在for循环中的应用/">闭包在for循环中的应用</a><a class="next" href="/blog/2017/01/06/ES6(2015)/">ES6</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://aj1219.github.io/blog"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/blog/tags/React/" style="font-size: 15px;">React</a> <a href="/blog/tags/DOM/" style="font-size: 15px;">DOM</a> <a href="/blog/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/blog/tags/前端/" style="font-size: 15px;">前端</a> <a href="/blog/tags/Go/" style="font-size: 15px;">Go</a> <a href="/blog/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/blog/tags/Git/" style="font-size: 15px;">Git</a> <a href="/blog/tags/JQuery/" style="font-size: 15px;">JQuery</a> <a href="/blog/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/blog/tags/模块化/" style="font-size: 15px;">模块化</a> <a href="/blog/tags/管理/" style="font-size: 15px;">管理</a> <a href="/blog/tags/TCP/" style="font-size: 15px;">TCP</a> <a href="/blog/tags/个人成长/" style="font-size: 15px;">个人成长</a> <a href="/blog/tags/面试/" style="font-size: 15px;">面试</a> <a href="/blog/tags/Aha/" style="font-size: 15px;">Aha</a> <a href="/blog/tags/技术参考/" style="font-size: 15px;">技术参考</a> <a href="/blog/tags/CSS3/" style="font-size: 15px;">CSS3</a> <a href="/blog/tags/电子书/" style="font-size: 15px;">电子书</a> <a href="/blog/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/blog/tags/go/" style="font-size: 15px;">go</a> <a href="/blog/tags/编程作业/" style="font-size: 15px;">编程作业</a> <a href="/blog/tags/https/" style="font-size: 15px;">https</a> <a href="/blog/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/blog/tags/Node/" style="font-size: 15px;">Node</a> <a href="/blog/tags/HTML/" style="font-size: 15px;">HTML</a> <a href="/blog/tags/shell/" style="font-size: 15px;">shell</a> <a href="/blog/tags/Unix/" style="font-size: 15px;">Unix</a> <a href="/blog/tags/SSH/" style="font-size: 15px;">SSH</a> <a href="/blog/tags/Vim/" style="font-size: 15px;">Vim</a> <a href="/blog/tags/计算机基础知识/" style="font-size: 15px;">计算机基础知识</a> <a href="/blog/tags/markdown/" style="font-size: 15px;">markdown</a> <a href="/blog/tags/心理学/" style="font-size: 15px;">心理学</a> <a href="/blog/tags/生活/" style="font-size: 15px;">生活</a> <a href="/blog/tags/网络/" style="font-size: 15px;">网络</a> <a href="/blog/tags/人生/" style="font-size: 15px;">人生</a> <a href="/blog/tags/Mac/" style="font-size: 15px;">Mac</a> <a href="/blog/tags/Apache/" style="font-size: 15px;">Apache</a> <a href="/blog/tags/坑/" style="font-size: 15px;">坑</a> <a href="/blog/tags/小程序/" style="font-size: 15px;">小程序</a> <a href="/blog/tags/兼容性/" style="font-size: 15px;">兼容性</a> <a href="/blog/tags/微信小程序/" style="font-size: 15px;">微信小程序</a> <a href="/blog/tags/DNS/" style="font-size: 15px;">DNS</a> <a href="/blog/tags/Ping/" style="font-size: 15px;">Ping</a> <a href="/blog/tags/读书笔记/" style="font-size: 15px;">读书笔记</a> <a href="/blog/tags/逻辑/" style="font-size: 15px;">逻辑</a> <a href="/blog/tags/redux/" style="font-size: 15px;">redux</a> <a href="/blog/tags/代码规范/" style="font-size: 15px;">代码规范</a> <a href="/blog/tags/webpack3/" style="font-size: 15px;">webpack3</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2021/08/02/Golang错误vs异常/">Golang错误vs异常</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2021/06/07/熟练ssh/">熟练ssh</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2021/04/14/周日消费指南/">幸福人生</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2021/04/09/物理像素、逻辑像素、CSS像素、PPI、设备像素比是什么/">物理像素、逻辑像素、CSS像素、PPI、设备像素比是什么</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2020/04/08/重新定义管理/">重新定义管理</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2020/03/18/OKR黄勇笔记笔记/">OKR黄勇笔记笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2020/03/18/自定义角色感/">自定义角色感</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2020/01/06/hello-Hexo/">Hello Hexo</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/12/25/Linux入门/">Linux入门</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2019/12/25/Nginx入门/">Nginx入门</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/blog/." rel="nofollow">Abel-Johnson's BLOG.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=1.0.0"></script></div></body></html>